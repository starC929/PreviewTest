import{U as y,r as _,D as me,K as fe,d,H as M,o as r,c as R,I as k,J as Q,h as l,e,f as t,k as A,L as j,M as H,l as g,p as m,F as J,m as $,A as O,C as _e,v as ke}from"./index-BjGPYSck.js";function ge(i){return y({url:"/data/DataUploadTask/list",method:"get",params:i})}function ve(i){return y({url:"/data/DataUploadTask/"+i,method:"get"})}function be(i){return y({url:"/data/DataUploadTask",method:"post",data:i})}function De(i){return y({url:"/data/DataUploadTask",method:"put",data:i})}function he(i){return y({url:"/data/DataUploadTask/"+i,method:"delete"})}const Te={class:"app-container"},ye={class:"dialog-footer"},Ue=_e({name:"DataUploadTask"}),we=Object.assign(Ue,{setup(i){const{proxy:f}=ke(),{upload_task_status:S}=f.useDict("upload_task_status"),q=_([]),v=_(!1),I=_(!0),U=_(!0),C=_([]),K=_(!0),P=_(!0),N=_(0),x=_(""),G=me({form:{},queryParams:{pageNum:1,pageSize:10,vin:null,taskId:null,taskStatus:null,createTime:null},rules:{vin:[{required:!0,message:"VIN不能为空",trigger:"blur"}],taskId:[{required:!0,message:"任务ID不能为空",trigger:"blur"}],taskStatus:[{required:!0,message:"任务状态不能为空",trigger:"change"}]}}),{queryParams:n,form:s,rules:W}=fe(G);function D(){I.value=!0,ge(n.value).then(u=>{q.value=u.rows,N.value=u.total,I.value=!1})}function X(){v.value=!1,B()}function B(){s.value={id:null,vin:null,taskId:null,taskStatus:null,createBy:null,createTime:null,updateBy:null,updateTime:null},f.resetForm("DataUploadTaskRef")}function V(){n.value.pageNum=1,D()}function Z(){f.resetForm("queryRef"),V()}function ee(u){C.value=u.map(o=>o.id),K.value=u.length!=1,P.value=!u.length}function ae(){B(),v.value=!0,x.value="添加上传任务"}function F(u){B();const o=u.id||C.value;ve(o).then(h=>{s.value=h.data,v.value=!0,x.value="修改上传任务"})}function le(){f.$refs.DataUploadTaskRef.validate(u=>{u&&(s.value.id!=null?De(s.value).then(o=>{f.$modal.msgSuccess("修改成功"),v.value=!1,D()}):be(s.value).then(o=>{f.$modal.msgSuccess("新增成功"),v.value=!1,D()}))})}function E(u){const o=u.id||C.value;f.$modal.confirm('是否确认删除上传任务编号为"'+o+'"的数据项？').then(function(){return he(o)}).then(()=>{D(),f.$modal.msgSuccess("删除成功")}).catch(()=>{})}function te(){f.download("data/DataUploadTask/export",{...n.value},`DataUploadTask_${new Date().getTime()}.xlsx`)}return D(),(u,o)=>{const h=d("el-input"),b=d("el-form-item"),L=d("el-option"),Y=d("el-select"),oe=d("el-date-picker"),p=d("el-button"),z=d("el-form"),w=d("el-col"),ne=d("right-toolbar"),ue=d("el-row"),c=d("el-table-column"),de=d("dict-tag"),se=d("el-table"),re=d("pagination"),ie=d("el-dialog"),T=M("hasPermi"),pe=M("loading");return r(),R("div",Te,[k(e(z,{model:l(n),ref:"queryRef",inline:!0,"label-width":"68px"},{default:t(()=>[e(b,{label:"VIN",prop:"vin"},{default:t(()=>[e(h,{modelValue:l(n).vin,"onUpdate:modelValue":o[0]||(o[0]=a=>l(n).vin=a),placeholder:"请输入VIN",clearable:"",onKeyup:A(V,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(b,{label:"任务ID",prop:"taskId"},{default:t(()=>[e(h,{modelValue:l(n).taskId,"onUpdate:modelValue":o[1]||(o[1]=a=>l(n).taskId=a),placeholder:"请输入任务ID",clearable:"",onKeyup:A(V,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(b,{label:"任务状态",prop:"taskStatus"},{default:t(()=>[e(Y,{modelValue:l(n).taskStatus,"onUpdate:modelValue":o[2]||(o[2]=a=>l(n).taskStatus=a),placeholder:"请选择任务状态",clearable:""},{default:t(()=>[(r(!0),R(j,null,H(l(S),a=>(r(),g(L,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(b,{label:"创建时间",prop:"createTime"},{default:t(()=>[e(oe,{clearable:"",modelValue:l(n).createTime,"onUpdate:modelValue":o[3]||(o[3]=a=>l(n).createTime=a),type:"date","value-format":"YYYY-MM-DD",placeholder:"请选择创建时间"},null,8,["modelValue"])]),_:1}),e(b,null,{default:t(()=>[e(p,{type:"primary",icon:"Search",onClick:V},{default:t(()=>[m("搜索")]),_:1}),e(p,{icon:"Refresh",onClick:Z},{default:t(()=>[m("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[Q,l(U)]]),e(ue,{gutter:10,class:"mb8"},{default:t(()=>[e(w,{span:1.5},{default:t(()=>[k((r(),g(p,{type:"primary",plain:"",icon:"Plus",onClick:ae},{default:t(()=>[m("新增")]),_:1})),[[T,["data:DataUploadTask:add"]]])]),_:1}),e(w,{span:1.5},{default:t(()=>[k((r(),g(p,{type:"success",plain:"",icon:"Edit",disabled:l(K),onClick:F},{default:t(()=>[m("修改")]),_:1},8,["disabled"])),[[T,["data:DataUploadTask:edit"]]])]),_:1}),e(w,{span:1.5},{default:t(()=>[k((r(),g(p,{type:"danger",plain:"",icon:"Delete",disabled:l(P),onClick:E},{default:t(()=>[m("删除")]),_:1},8,["disabled"])),[[T,["data:DataUploadTask:remove"]]])]),_:1}),e(w,{span:1.5},{default:t(()=>[k((r(),g(p,{type:"warning",plain:"",icon:"Download",onClick:te},{default:t(()=>[m("导出")]),_:1})),[[T,["data:DataUploadTask:export"]]])]),_:1}),e(ne,{showSearch:l(U),"onUpdate:showSearch":o[4]||(o[4]=a=>J(U)?U.value=a:null),onQueryTable:D},null,8,["showSearch"])]),_:1}),k((r(),g(se,{data:l(q),onSelectionChange:ee},{default:t(()=>[e(c,{type:"selection",width:"55",align:"center"}),e(c,{label:"序号",align:"center",prop:"id"}),e(c,{label:"VIN",align:"center",prop:"vin"}),e(c,{label:"任务ID",align:"center",prop:"taskId",width:"400"}),e(c,{label:"任务状态",align:"center",prop:"taskStatus"},{default:t(a=>[e(de,{options:l(S),value:a.row.taskStatus},null,8,["options","value"])]),_:1}),e(c,{label:"创建者",align:"center",prop:"createBy"}),e(c,{label:"创建时间",align:"center",prop:"createTime",width:"180"},{default:t(a=>[$("span",null,O(u.parseTime(a.row.createTime)),1)]),_:1}),e(c,{label:"更新者",align:"center",prop:"updateBy"}),e(c,{label:"更新时间",align:"center",prop:"updateTime",width:"180"},{default:t(a=>[$("span",null,O(u.parseTime(a.row.updateTime)),1)]),_:1}),e(c,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:t(a=>[k((r(),g(p,{link:"",type:"primary",icon:"Edit",onClick:ce=>F(a.row)},{default:t(()=>[m("修改")]),_:2},1032,["onClick"])),[[T,["data:DataUploadTask:edit"]]]),k((r(),g(p,{link:"",type:"primary",icon:"Delete",onClick:ce=>E(a.row)},{default:t(()=>[m("删除")]),_:2},1032,["onClick"])),[[T,["data:DataUploadTask:remove"]]])]),_:1})]),_:1},8,["data"])),[[pe,l(I)]]),k(e(re,{total:l(N),page:l(n).pageNum,"onUpdate:page":o[5]||(o[5]=a=>l(n).pageNum=a),limit:l(n).pageSize,"onUpdate:limit":o[6]||(o[6]=a=>l(n).pageSize=a),onPagination:D},null,8,["total","page","limit"]),[[Q,l(N)>0]]),e(ie,{title:l(x),modelValue:l(v),"onUpdate:modelValue":o[10]||(o[10]=a=>J(v)?v.value=a:null),width:"500px","append-to-body":""},{footer:t(()=>[$("div",ye,[e(p,{type:"primary",onClick:le},{default:t(()=>[m("确 定")]),_:1}),e(p,{onClick:X},{default:t(()=>[m("取 消")]),_:1})])]),default:t(()=>[e(z,{ref:"DataUploadTaskRef",model:l(s),rules:l(W),"label-width":"80px"},{default:t(()=>[e(b,{label:"VIN",prop:"vin"},{default:t(()=>[e(h,{modelValue:l(s).vin,"onUpdate:modelValue":o[7]||(o[7]=a=>l(s).vin=a),placeholder:"请输入VIN"},null,8,["modelValue"])]),_:1}),e(b,{label:"任务ID",prop:"taskId"},{default:t(()=>[e(h,{modelValue:l(s).taskId,"onUpdate:modelValue":o[8]||(o[8]=a=>l(s).taskId=a),placeholder:"请输入任务ID"},null,8,["modelValue"])]),_:1}),e(b,{label:"任务状态",prop:"taskStatus"},{default:t(()=>[e(Y,{modelValue:l(s).taskStatus,"onUpdate:modelValue":o[9]||(o[9]=a=>l(s).taskStatus=a),placeholder:"请选择任务状态"},{default:t(()=>[(r(!0),R(j,null,H(l(S),a=>(r(),g(L,{key:a.value,label:a.label,value:parseInt(a.value)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{we as default};
